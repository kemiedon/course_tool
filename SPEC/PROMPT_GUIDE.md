# PROMPT_GUIDE - 對話指令規範

## 📋 對話行為準則

### 基本原則

- ✅ 執行前先提出方案、說明驗證條件、等待確認
- ✅ 重大變更前先列出風險、回退方案與影響範圍
- ✅ 伺服器啟停可直接執行（不需確認），其餘動作需先提案
- ✅ 有更好方案時主動提出，清楚說明優缺點與採用理由
- ✅ 所有技術決策以 PROMPT_GUIDE 規範為準；偏離時需先說明理由與回退方式
- ✅ 變更需同步更新文件與 UI 文案，維持用語一致
- ✅ 安全/路徑/刪除限制需明確檢查
- ✅ 回應需簡潔、可操作；提供必要指令與驗證步驟

### 禁止行為

- ❌ 不在對話中展示實作程式碼（除非明確要求）
- ❌ 不要一口氣執行，必須等確認（伺服器啟停除外）
- ❌ 不私自調整技術棧或流程（未經確認）
- ❌ 不跳過文件更新與提交流程

---

## 🌏 核心規範

### 1. 語言規定

**所有與使用者的對話必須使用繁體中文（Traditional Chinese）**

#### 適用範圍：

- ✅ 所有回應、說明、註解都必須使用繁體中文
- ✅ 代碼註解也應使用繁體中文
- ✅ 文檔和規格書必須使用繁體中文撰寫
- ✅ UI 介面文案使用繁體中文
- ✅ 錯誤訊息與提示訊息使用繁體中文

#### 範例：

```javascript
// ✅ 正確：使用繁體中文註解
// 初始化課程資料
const initCourseData = () => {
  // 從 API 獲取課程列表
  fetchCourses()
}

// ❌ 錯誤：使用英文註解
// Initialize course data
const initCourseData = () => {
  // Fetch course list from API
  fetchCourses()
}
```

---

### 2. 版本控制與提交規範

**每當完成一個任務後，必須自動執行 git commit 和 push 到 repository**

#### Commit 訊息格式

**格式規則：**

```
(Y-m-d H:i:s)-版本號
```

**版本號規則：**

- 從 `1.0` 開始
- 每次提交遞增 `0.1`（例如：1.0 → 1.1 → 1.2）
- 重大更新可跳號（例如：1.9 → 2.0）

**格式範例：**

```
(2025-12-05 23:16:32)-1.0
(2025-12-05 23:20:15)-1.1
(2025-12-05 23:25:40)-1.2
(2025-12-06 10:30:00)-1.3
(2025-12-06 15:45:22)-2.0
```

#### 自動化提交流程

**標準流程：**

1. **完成任務後自動執行**：

   ```bash
   git add .
   ```
2. **建立 commit**（使用指定格式）：

   ```bash
   git commit -m "(2025-12-05 23:16:32)-1.0"
   ```
3. **自動推送到遠端倉庫**：

   ```bash
   git push
   ```
4. **版本號自動遞增**：

   - 查詢上次 commit 的版本號
   - 自動遞增 0.1
   - 無需詢問使用者同意

**重要注意事項：**

- ⚠️ 每次更新程式碼後，自動執行 push 到 repository
- ⚠️ 無需詢問使用者同意（除非涉及重大變更）
- ⚠️ 版本號根據上次提交自動遞增 0.1
- ⚠️ 若 git 出現衝突或錯誤，需通知使用者並等待指示

#### 提交時機

**需要立即提交的情況：**

- ✅ 完成一個獨立功能
- ✅ 修復一個 Bug
- ✅ 完成一個元件開發
- ✅ 更新文檔或規格書
- ✅ 調整設定檔

**不需要提交的情況：**

- ❌ 測試中的臨時代碼
- ❌ 尚未完成的半成品
- ❌ 實驗性質的變更

---

### 3. 自動預覽與測試

**每次完成一個功能後，自動開啟預覽進行測試**

#### 預覽流程：

1. **啟動開發伺服器**（如果尚未啟動）：

   ```bash
   npm run dev
   ```
2. **自動開啟 Simple Browser**：

   - 使用 VS Code 內建的 Simple Browser
   - 預設 URL：`http://localhost:5173`（Vite）或 `http://localhost:3000`
   - 根據專案設定自動調整端口
3. **進行功能測試**：

   - 驗證新功能是否正常運作
   - 檢查 UI 顯示是否正確
   - 測試互動功能
   - 確認沒有 console 錯誤
4. **回報測試結果**：

   - ✅ 功能正常：說明「功能已完成並測試通過」
   - ❌ 發現問題：說明問題並提供修復方案

#### 預覽時機：

- ✅ 完成新頁面開發
- ✅ 完成新元件開發
- ✅ 修改 UI 樣式
- ✅ 整合新功能
- ✅ 修復視覺性 Bug

---

## 🔧 技術決策規範

### 技術棧選擇

**必須遵守的技術棧（除非使用者明確要求變更）：**

#### 前端技術

- **框架**: Vue 3 (Composition API)
- **建構工具**: Vite
- **樣式**: Tailwind CSS
- **狀態管理**: Pinia
- **路由**: Vue Router
- **日期處理**: 原生 JS 或 date-fns
- **圖示**: Font Awesome
- **日曆**: FullCalendar

#### 後端服務

- **資料庫**: Firebase Firestore
- **認證**: Firebase Authentication
- **儲存**: Firebase Storage
- **AI 服務**: Google Gemini API
- **表單**: Google Forms API

### 偏離技術棧的處理方式

**如需使用其他技術，必須：**

1. **說明理由**：

   - 為什麼需要偏離現有技術棧？
   - 現有技術無法滿足的需求是什麼？
2. **評估影響**：

   - 對現有程式碼的影響範圍
   - 學習成本與維護成本
   - 專案體積與效能影響
3. **提供方案**：

   - 推薦方案與替代方案
   - 優缺點比較
   - 實作複雜度評估
4. **等待確認**：

   - 等待使用者明確同意
   - 不可私自決定並執行

---

## 📝 文件更新規範

### 需要同步更新的文件

**程式碼變更時，必須同步更新：**

1. **SPEC/MAIN.md**：

   - 功能規格變更
   - API 介面變更
   - 資料結構變更
2. **DEVELOPMENT.md**：

   - 開發進度更新
   - 新增開發指引
   - 問題解決方案
3. **README.md**：

   - 安裝步驟變更
   - 使用方式更新
   - 環境變數新增
4. **程式碼註解**：

   - 函數功能說明
   - 複雜邏輯註解
   - API 參數說明

### UI 文案一致性

**確保所有介面文字統一：**

- ✅ 按鈕文字一致（例如：「儲存」vs「保存」統一使用一個）
- ✅ 欄位名稱一致（例如：「電子郵件」vs「Email」統一使用一個）
- ✅ 錯誤訊息格式一致
- ✅ 成功訊息格式一致
- ✅ 專有名詞翻譯一致

**範例：**

```javascript
// ✅ 正確：統一使用「課程」
const courseList = ref([])
const createCourse = () => {}
toastStore.success('課程建立成功')

// ❌ 錯誤：混用「課程」與「課堂」
const courseList = ref([])
const createClass = () => {}
toastStore.success('課堂建立成功')
```

---

## ⚠️ 安全與風險控管

### 路徑安全檢查

**執行檔案操作前必須檢查：**

1. **路徑合法性**：

   - 路徑是否在專案目錄內
   - 不允許訪問系統敏感目錄
   - 不允許使用 `../` 跳出專案目錄
2. **檔案存在性**：

   - 讀取前確認檔案存在
   - 寫入前確認目錄存在
   - 刪除前確認檔案存在

### 刪除操作限制

**刪除檔案/目錄前必須：**

1. **確認範圍**：

   - 明確列出將被刪除的檔案/目錄
   - 說明刪除原因
   - 評估影響範圍
2. **風險警告**：

   - 標註為 **⚠️ 高風險操作**
   - 說明無法復原
   - 提供備份建議
3. **等待確認**：

   - 必須等待使用者明確同意
   - 不可自動執行刪除

**範例：**

```
⚠️ 高風險操作：刪除檔案

將要刪除：
- src/components/OldComponent.vue
- src/views/DeprecatedPage.vue

影響：
- 相關引用需要手動更新
- 無法復原

建議：
- 先執行 git commit 備份當前狀態
- 確認沒有其他檔案引用這些元件

是否繼續？(需要明確確認)
```

### 重大變更處理

**以下操作視為重大變更，需特別處理：**

1. **資料庫結構變更**
2. **API 介面變更**
3. **認證流程變更**
4. **第三方服務整合變更**
5. **環境變數新增/移除**

**處理流程：**

1. **列出風險**：

   - 可能造成的問題
   - 影響的功能範圍
   - 相依性變更
2. **回退方案**：

   - 如何恢復到變更前狀態
   - 需要備份的資料
   - 復原所需時間
3. **影響範圍**：

   - 前端影響
   - 後端影響
   - 使用者體驗影響
4. **等待確認**：

   - 提供完整資訊後等待同意
   - 不可自行決定執行

---

## 💬 回應格式規範

### 標準回應結構

**所有回應應包含：**

1. **簡要說明**（1-2 句話）
2. **方案或執行步驟**（條列式）
3. **驗證方法**（如何確認成功）
4. **風險提示**（如有）

**範例：**

```
我將為您新增課程排程功能。

執行步驟：
1. 建立 CourseSchedule.vue 元件
2. 整合 FullCalendar 套件
3. 實作日期計算邏輯
4. 更新 DEVELOPMENT.md

驗證方法：
- 開啟 http://localhost:5173/courses/create
- 進入「排課設定」步驟
- 選擇日期和時間
- 確認日曆正確顯示

是否繼續？
```

### 簡潔原則

- ✅ 避免冗長的程式碼展示（除非明確要求）
- ✅ 使用條列式而非大段文字
- ✅ 重點標註（使用 ✅ ❌ ⚠️ 等符號）
- ✅ 分段清晰，易於閱讀

### 可操作性

**每個回應都應提供：**

- 明確的下一步動作
- 必要的指令或程式碼
- 驗證步驟
- 問題解決方案

---

## 🔄 工作流程範例

### 標準開發流程

```
1. 接收任務
   ↓
2. 分析需求，提出方案
   ↓
3. 等待使用者確認
   ↓
4. 執行開發
   ↓
5. 更新相關文件
   ↓
6. 自動 git commit & push
   ↓
7. 開啟 Simple Browser 預覽
   ↓
8. 回報完成狀態與測試結果
```

### 伺服器管理流程（可直接執行）

```
1. 啟動開發伺服器
   ↓
2. 執行 npm run dev
   ↓
3. 確認伺服器正常運行
   ↓
4. 開啟瀏覽器預覽
   ↓
5. 回報啟動狀態
```

---

## 📌 快速檢查清單

**每次完成任務前確認：**

- [ ] 使用繁體中文
- [ ] 程式碼有適當註解
- [ ] UI 文案統一
- [ ] 相關文件已更新
- [ ] 已執行 git commit & push
- [ ] 版本號正確遞增
- [ ] 已開啟預覽測試
- [ ] 功能正常運作
- [ ] 無 console 錯誤

---

## 🎯 總結

**核心原則：**

1. 🌏 **全程繁體中文**
2. 💬 **先提案，後執行**（伺服器啟停除外）
3. 📝 **同步更新文件**
4. 🔄 **自動 git 提交**
5. 👁️ **自動開啟預覽**
6. ⚠️ **明確風險控管**
7. ✅ **簡潔可操作**

**記住：**

- 技術決策以此規範為準
- 偏離時需說明理由
- 重大變更需等待確認
- 保持溝通清晰簡潔

---

**文件版本**: 1.0
**最後更新**: 2025-12-05
**適用專案**: 課程規劃工具 (Course Planning Tool)
